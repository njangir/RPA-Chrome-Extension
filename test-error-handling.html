<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Error Handling Test Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .test-section {
            border: 1px solid #ddd;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
            background: #f9f9f9;
        }
        
        .test-section h3 {
            margin-top: 0;
            color: #333;
        }
        
        .test-instructions {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .test-instructions h3 {
            margin-top: 0;
            color: #0066cc;
        }
        
        .test-instructions ol {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .test-instructions li {
            margin: 5px 0;
        }
        
        .error-test {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .error-test h4 {
            margin-top: 0;
            color: #856404;
        }
        
        .error-test p {
            margin: 5px 0;
            color: #856404;
        }
        
        .error-test strong {
            color: #6c5ce7;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        input:focus, textarea:focus, select:focus {
            border-color: #007bff;
            outline: none;
            box-shadow: 0 0 5px rgba(0,123,255,0.3);
        }
        
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        button:hover {
            background: #0056b3;
        }
        
        .test-btn {
            background: #dc3545;
        }
        
        .test-btn:hover {
            background: #c82333;
        }
        
        .success-btn {
            background: #28a745;
        }
        
        .success-btn:hover {
            background: #218838;
        }
        
        .warning-btn {
            background: #ffc107;
            color: #212529;
        }
        
        .warning-btn:hover {
            background: #e0a800;
        }
        
        .hidden {
            display: none;
        }
        
        .test-results {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            display: none;
        }
        
        .test-results h3 {
            margin-top: 0;
            color: #333;
        }
        
        .test-results .result-item {
            background: white;
            border: 1px solid #ddd;
            padding: 10px;
            margin: 5px 0;
            border-radius: 3px;
            font-family: monospace;
            font-size: 12px;
        }
        
        .test-results .result-item.success {
            border-color: #28a745;
            background: #d4edda;
        }
        
        .test-results .result-item.error {
            border-color: #dc3545;
            background: #f8d7da;
        }
        
        .test-results .result-item.warning {
            border-color: #ffc107;
            background: #fff3cd;
        }
        
        .dynamic-content {
            margin: 20px 0;
            padding: 15px;
            border: 2px dashed #ddd;
            border-radius: 5px;
            min-height: 50px;
        }
        
        .dynamic-content:empty::before {
            content: "Dynamic content will appear here";
            color: #999;
            font-style: italic;
        }
        
        .error-element {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        
        .slow-loading {
            opacity: 0.5;
            transition: opacity 0.3s;
        }
        
        .slow-loading.loaded {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ö†Ô∏è Error Handling Test Page</h1>
        
        <div class="test-instructions">
            <h3>üß™ Testing Instructions</h3>
            <p>This page tests the error handling functionality of the Chrome extension:</p>
            <ol>
                <li>Load the Chrome extension in your browser</li>
                <li>Record some steps on this page</li>
                <li>Start playback and observe error handling behavior</li>
                <li>Test different error scenarios below</li>
                <li>Verify that you can skip, retry, or stop on errors</li>
            </ol>
        </div>
        
        <div class="test-section">
            <h3>üéØ Element Not Found Errors</h3>
            <div class="error-test">
                <h4>Test 1: Non-existent Selector</h4>
                <p>This will cause "Element not found" errors during playback:</p>
                <button onclick="createNonExistentElement()" class="test-btn">Create Element with Bad Selector</button>
                <div id="badSelectorContainer" class="dynamic-content"></div>
            </div>
            
            <div class="error-test">
                <h4>Test 2: Dynamic Content</h4>
                <p>Elements that appear/disappear dynamically:</p>
                <button onclick="toggleDynamicElement()" class="test-btn">Toggle Dynamic Element</button>
                <div id="dynamicContainer" class="dynamic-content">
                    <div id="dynamicElement" class="hidden">This element appears/disappears</div>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h3>üîß Input Field Errors</h3>
            <div class="error-test">
                <h4>Test 3: Disabled Inputs</h4>
                <p>Input fields that become disabled:</p>
                <div class="form-group">
                    <label for="testInput1">Normal Input:</label>
                    <input type="text" id="testInput1" placeholder="This input works normally">
                </div>
                <div class="form-group">
                    <label for="testInput2">Disabled Input:</label>
                    <input type="text" id="testInput2" placeholder="This input will be disabled" disabled>
                </div>
                <button onclick="toggleInputState()" class="test-btn">Toggle Input State</button>
            </div>
            
            <div class="error-test">
                <h4>Test 4: Read-only Inputs</h4>
                <p>Input fields that become read-only:</p>
                <div class="form-group">
                    <label for="testInput3">Read-only Input:</label>
                    <input type="text" id="testInput3" placeholder="This input will be read-only" readonly>
                </div>
                <button onclick="toggleReadOnlyState()" class="test-btn">Toggle Read-only State</button>
            </div>
        </div>
        
        <div class="test-section">
            <h3>üåê Navigation Errors</h3>
            <div class="error-test">
                <h4>Test 5: Page Redirects</h4>
                <p>Links that cause page navigation:</p>
                <button onclick="createRedirectLink()" class="test-btn">Create Redirect Link</button>
                <div id="redirectContainer" class="dynamic-content"></div>
            </div>
            
            <div class="error-test">
                <h4>Test 6: Slow Loading Elements</h4>
                <p>Elements that load slowly or fail to load:</p>
                <button onclick="createSlowElement()" class="test-btn">Create Slow Loading Element</button>
                <div id="slowContainer" class="dynamic-content"></div>
            </div>
        </div>
        
        <div class="test-section">
            <h3>üìù Form Submission Errors</h3>
            <div class="error-test">
                <h4>Test 7: Form Validation Errors</h4>
                <p>Forms with validation that might fail:</p>
                <form id="testForm" onsubmit="return false;">
                    <div class="form-group">
                        <label for="emailInput">Email (required):</label>
                        <input type="email" id="emailInput" required>
                    </div>
                    <div class="form-group">
                        <label for="passwordInput">Password (min 8 chars):</label>
                        <input type="password" id="passwordInput" minlength="8" required>
                    </div>
                    <button type="submit" onclick="submitForm()" class="test-btn">Submit Form</button>
                </form>
            </div>
        </div>
        
        <div class="test-section">
            <h3>üéÆ Interactive Elements</h3>
            <div class="error-test">
                <h4>Test 8: Clickable Elements</h4>
                <p>Buttons and links that might not work:</p>
                <button onclick="createClickableElements()" class="test-btn">Create Clickable Elements</button>
                <div id="clickableContainer" class="dynamic-content"></div>
            </div>
            
            <div class="error-test">
                <h4>Test 9: Dropdown/Select Elements</h4>
                <p>Select elements with dynamic options:</p>
                <div class="form-group">
                    <label for="testSelect">Dynamic Select:</label>
                    <select id="testSelect">
                        <option value="">Select an option</option>
                    </select>
                </div>
                <button onclick="populateSelect()" class="test-btn">Populate Select</button>
                <button onclick="clearSelect()" class="test-btn">Clear Select</button>
            </div>
        </div>
        
        <div class="test-section">
            <h3>‚úÖ Success Scenarios</h3>
            <div class="error-test">
                <h4>Test 10: Working Elements</h4>
                <p>These elements should work normally:</p>
                <div class="form-group">
                    <label for="workingInput">Working Input:</label>
                    <input type="text" id="workingInput" placeholder="This input should work fine">
                </div>
                <button onclick="testWorkingButton()" class="success-btn">Working Button</button>
                <div id="workingResult" class="dynamic-content"></div>
            </div>
        </div>
        
        <div class="test-results" id="testResults">
            <h3>Test Results:</h3>
            <div id="resultsContent"></div>
        </div>
    </div>

    <script>
        let testResults = [];
        
        // Test 1: Non-existent Selector
        function createNonExistentElement() {
            const container = document.getElementById('badSelectorContainer');
            container.innerHTML = `
                <div class="error-element">
                    <strong>‚ö†Ô∏è This element has a problematic selector</strong>
                    <p>This element will be hard to find during playback because it has a complex, changing ID.</p>
                    <button onclick="testBadSelector()" class="test-btn">Test Bad Selector</button>
                </div>
            `;
        }
        
        function testBadSelector() {
            // This will likely fail during playback
            const element = document.querySelector('#badSelectorContainer > div > button');
            if (element) {
                element.style.background = '#28a745';
                element.textContent = 'Found!';
            }
        }
        
        // Test 2: Dynamic Content
        function toggleDynamicElement() {
            const element = document.getElementById('dynamicElement');
            if (element) {
                element.classList.toggle('hidden');
            }
        }
        
        // Test 3: Input State
        function toggleInputState() {
            const input = document.getElementById('testInput2');
            input.disabled = !input.disabled;
            input.placeholder = input.disabled ? 'This input is now disabled' : 'This input is now enabled';
        }
        
        // Test 4: Read-only State
        function toggleReadOnlyState() {
            const input = document.getElementById('testInput3');
            input.readOnly = !input.readOnly;
            input.placeholder = input.readOnly ? 'This input is now read-only' : 'This input is now editable';
        }
        
        // Test 5: Redirect Link
        function createRedirectLink() {
            const container = document.getElementById('redirectContainer');
            container.innerHTML = `
                <div class="error-element">
                    <strong>‚ö†Ô∏è This link will cause a redirect</strong>
                    <p>Clicking this link will navigate away from the page.</p>
                    <a href="https://www.google.com" target="_blank" class="test-btn" style="display: inline-block; text-decoration: none; color: white;">Go to Google</a>
                </div>
            `;
        }
        
        // Test 6: Slow Loading Element
        function createSlowElement() {
            const container = document.getElementById('slowContainer');
            container.innerHTML = `
                <div class="slow-loading">
                    <strong>‚è≥ Slow Loading Element</strong>
                    <p>This element takes time to load...</p>
                </div>
            `;
            
            // Simulate slow loading
            setTimeout(() => {
                const element = container.querySelector('.slow-loading');
                if (element) {
                    element.classList.add('loaded');
                    element.innerHTML = `
                        <strong>‚úÖ Element Loaded</strong>
                        <p>This element has finished loading.</p>
                    `;
                }
            }, 3000);
        }
        
        // Test 7: Form Submission
        function submitForm() {
            const email = document.getElementById('emailInput').value;
            const password = document.getElementById('passwordInput').value;
            
            if (!email || !password) {
                alert('Please fill in all required fields');
                return false;
            }
            
            if (password.length < 8) {
                alert('Password must be at least 8 characters long');
                return false;
            }
            
            alert('Form submitted successfully!');
            return false;
        }
        
        // Test 8: Clickable Elements
        function createClickableElements() {
            const container = document.getElementById('clickableContainer');
            container.innerHTML = `
                <div class="error-element">
                    <strong>üéØ Clickable Elements</strong>
                    <p>These buttons have various behaviors:</p>
                    <button onclick="buttonClickHandler('button1')" class="test-btn">Button 1</button>
                    <button onclick="buttonClickHandler('button2')" class="success-btn">Button 2</button>
                    <button onclick="buttonClickHandler('button3')" class="warning-btn">Button 3</button>
                </div>
            `;
        }
        
        function buttonClickHandler(buttonId) {
            const result = document.getElementById('workingResult');
            result.innerHTML = `<div class="result-item success">Button ${buttonId} clicked successfully!</div>`;
        }
        
        // Test 9: Select Elements
        function populateSelect() {
            const select = document.getElementById('testSelect');
            select.innerHTML = `
                <option value="">Select an option</option>
                <option value="option1">Option 1</option>
                <option value="option2">Option 2</option>
                <option value="option3">Option 3</option>
            `;
        }
        
        function clearSelect() {
            const select = document.getElementById('testSelect');
            select.innerHTML = '<option value="">Select an option</option>';
        }
        
        // Test 10: Working Elements
        function testWorkingButton() {
            const result = document.getElementById('workingResult');
            result.innerHTML = `
                <div class="result-item success">
                    <strong>‚úÖ Success!</strong>
                    <p>This button works correctly and should not cause errors during playback.</p>
                    <p>Timestamp: ${new Date().toLocaleString()}</p>
                </div>
            `;
        }
        
        // Error simulation functions
        function simulateError(errorType) {
            const error = new Error(`Simulated ${errorType} error`);
            error.name = errorType;
            throw error;
        }
        
        // Test result logging
        function logTestResult(testName, success, message) {
            testResults.push({
                test: testName,
                success: success,
                message: message,
                timestamp: new Date().toISOString()
            });
            
            updateTestResults();
        }
        
        function updateTestResults() {
            const resultsDiv = document.getElementById('testResults');
            const resultsContent = document.getElementById('resultsContent');
            
            if (testResults.length > 0) {
                resultsDiv.style.display = 'block';
                
                let results = '<h4>Recent Test Results:</h4>';
                results += '<div class="error-test">';
                
                testResults.slice(-10).reverse().forEach(result => {
                    const resultClass = result.success ? 'success' : 'error';
                    results += `
                        <div class="result-item ${resultClass}">
                            <strong>${result.test}</strong> - 
                            ${result.success ? '‚úÖ' : '‚ùå'} 
                            ${result.message} - 
                            ${new Date(result.timestamp).toLocaleString()}
                        </div>
                    `;
                });
                
                results += '</div>';
                resultsContent.innerHTML = results;
            }
        }
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Error handling test page loaded');
            console.log('Start recording in the extension and test various error scenarios');
            
            // Log page load
            logTestResult('Page Load', true, 'Error handling test page loaded successfully');
        });
        
        // Global error handler
        window.addEventListener('error', function(event) {
            console.error('Global error caught:', event.error);
            logTestResult('Global Error', false, event.error.message);
        });
        
        // Unhandled promise rejection handler
        window.addEventListener('unhandledrejection', function(event) {
            console.error('Unhandled promise rejection:', event.reason);
            logTestResult('Promise Rejection', false, event.reason.message || event.reason);
        });
    </script>
</body>
</html>
